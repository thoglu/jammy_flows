<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Documentation &mdash; jammy_flows master documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> jammy_flows
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general">General</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.extra_functions">Main class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.amortizable_mlp">Amortizable MLP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.bisection_n_newton">Numerical inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#helper-functions">Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-jammy_flows.layers.layer_base">Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#euclidean-flow-layers">Euclidean flow layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.euclidean_base">Euclidean Base</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.euclidean_do_nothing">Identity layer (“x”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.multivariate_normal">Multivariate Normal (“t”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.gaussianization_flow">Gaussianization flow (“g”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.polynomial_stretch_flow">Polynomial stretch flow (“p”)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.spheres.sphere_base">Spherical flow layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.spherical_do_nothing">Identity layer (“y”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.moebius_1d">Moebius 1-d circle flow (“m”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.splines_1d">Circular 1-d spline flow (“o”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.segmented_sphere_nd">Segmented 2-d sphere flow (“n”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.exponential_map_s2">Exponential map 2-d sphere flow (“v”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.cnf_sphere_charts">Chart-based continuous 2-d sphere flow (“c”)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.intervals.interval_base">Interval flow layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.simplex.simplex_base">Simplex flow layers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">jammy_flows</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>API Documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/thoglu/jammy_flows/blob/main/docs/source/usage/api.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-jammy_flows.extra_functions">
<span id="main-class"></span><h3>Main class<a class="headerlink" href="#module-jammy_flows.extra_functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="jammy_flows.extra_functions.log_one_plus_exp_x_to_a_minus_1">
<code class="sig-prename descclassname">jammy_flows.extra_functions.</code><code class="sig-name descname">log_one_plus_exp_x_to_a_minus_1</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.extra_functions.log_one_plus_exp_x_to_a_minus_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the logarithm of ((1+exp(x))**a - 1) / ((1+exp(x))**a)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Size (B,D)</p></li>
<li><p><strong>a</strong> (<em>Tensor</em>) – Size (B,1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tensor</dt><dd><p>Result</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-jammy_flows.amortizable_mlp">
<span id="amortizable-mlp"></span><h3>Amortizable MLP<a class="headerlink" href="#module-jammy_flows.amortizable_mlp" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.amortizable_mlp.AmortizableMLP">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.amortizable_mlp.</code><code class="sig-name descname">AmortizableMLP</code><span class="sig-paren">(</span><em class="sig-param">input_dim</em>, <em class="sig-param">hidden_dims</em>, <em class="sig-param">output_dim</em>, <em class="sig-param">highway_mode=0</em>, <em class="sig-param">low_rank_approximations=0</em>, <em class="sig-param">nonlinearity='tanh'</em>, <em class="sig-param">use_permanent_parameters=True</em>, <em class="sig-param">svd_mode='smart'</em>, <em class="sig-param">precise_mlp_structure={}</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.amortizable_mlp.AmortizableMLP" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.amortizable_mlp.AmortizableMLP.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_dim</em>, <em class="sig-param">hidden_dims</em>, <em class="sig-param">output_dim</em>, <em class="sig-param">highway_mode=0</em>, <em class="sig-param">low_rank_approximations=0</em>, <em class="sig-param">nonlinearity='tanh'</em>, <em class="sig-param">use_permanent_parameters=True</em>, <em class="sig-param">svd_mode='smart'</em>, <em class="sig-param">precise_mlp_structure={}</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.amortizable_mlp.AmortizableMLP.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>MLP class that allows for amortization of all of its parameters.
Supports low-rank approximations to weight matrices and 5 different settings of connectivity (“highway modes”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>output</em>) – Input dimension of the overall module.</p></li>
<li><p><strong>hidden_dims</strong> (<em>str/int/list</em><em>(</em><em>int</em><em>)</em>) – Defines hidden dimension structure of all MLPs, depending on <em>highway_mode</em> how they are used. Hidden dimensionality is given by integers, separated by dash. I.e. 64-64.</p></li>
<li><p><strong>dim</strong> – Output dimension of the overall module.</p></li>
<li><p><strong>highway_mode</strong> (<em>int</em>) – <p>Defines connectivity structure.</p>
<div class="line-block">
<div class="line"><strong>0</strong>: Default MLP with a given number of hidden layers defined by <em>hidden_dims</em>.</div>
<div class="line"><strong>1</strong>: Like mode 0 but with an extra skip connection using a linear matrix connecting input and output.</div>
<div class="line"><strong>2</strong>: Like mode 1 but multiple one-hidden-layer MLPs that all connect from input to output instead of the single MLP. Each hidden layer of those MLPs is defined by <em>hidden_dims</em>.</div>
<div class="line"><strong>3</strong>: Like mode 2 but the 2nd to nth MLP connects from the previous output to the next output, instead of input to output. Additionally, there are skip connections between all stages.</div>
<div class="line"><strong>4</strong>: Like mode 3, but the 2nd to nth MLP connections from a union of [input,previous output] to next output. Additionally, there are skip connections between all stages.</div>
</div>
</p></li>
<li><p><strong>low_rank_approximation</strong> (<em>int/list</em><em>(</em><em>int</em><em>)</em>) – Defines low-rank approximation of all matrices. If 0 or smaller, full rank is assumed.</p></li>
<li><p><strong>nonlinearity</strong> (<em>str</em>) – Nonlinearity used.</p></li>
<li><p><strong>use_permanent_parameters</strong> (<em>bool</em>) – If False, is used in amortization mode, i.e. all parameters are input in <em>foward</em> as <em>extra_inputs</em>.</p></li>
<li><p><strong>svd_mode</strong> (<em>str</em>) – One of [“naive”, “smart”]. Smart takes a full normal matrix if the rank is its max rank, then a naive low-rank approximation is less parameter efficient. Naive just always makes a SVD based low-rank approximation, which can be less efficient sometimes.</p></li>
<li><p><strong>precise_mlp_structure</strong> (<em>dict</em>) – Allows to pass a dict with similar structure as <em>sub_mlp_structures</em> (see code), in order to have more customization, i.e. per-matrix varying low-ranks etc.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.amortizable_mlp.AmortizableMLP.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">extra_inputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.amortizable_mlp.AmortizableMLP.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the AmortizableMLP to target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>Tensor</em>) – Input tensor of shape (B, D)</p></li>
<li><p><strong>extra_inputs</strong> (<em>Tensor/None</em>) – If given, amortizes all parameters of the AmortizableMLP.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tensor</dt><dd><p>Output of the AmortizableMLP.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.amortizable_mlp.AmortizableMLP.initialize_uvbs">
<code class="sig-name descname">initialize_uvbs</code><span class="sig-paren">(</span><em class="sig-param">fix_total=None</em>, <em class="sig-param">fix_final_bias=None</em>, <em class="sig-param">prev_damping_factor=1000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.amortizable_mlp.AmortizableMLP.initialize_uvbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the parameters of the MLPs. Either all parameters are initialized similar to default procedures in pytorch (fix_total and fix_final_bias None),
or all parameters are handed over (fix_total given), or the final bias vector is handed over (fix_final_bias given).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fix_total</strong> (<em>None/Tensor</em>) – If not None, has to be of size of all AmortizableMLP params to initialize all params of all MLPs.</p></li>
<li><p><strong>fix_final_bias</strong> (<em>None/Tensor</em>) – If not None, has to be of size of the target dimension (final bias) to set the final bias vector.</p></li>
<li><p><strong>prev_damping_factor</strong> (<em>float</em>) – Used to dampen previous weights/biases of init tensor when <em>fix_final_bias</em> is given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.amortizable_mlp.AmortizableMLP.obtain_default_init_tensor">
<code class="sig-name descname">obtain_default_init_tensor</code><span class="sig-paren">(</span><em class="sig-param">fix_final_bias=None</em>, <em class="sig-param">prev_damping_factor=1000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.amortizable_mlp.AmortizableMLP.obtain_default_init_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains a tensor that fits the shape of the AmortizableMLP parrameters according to standard kaiman init rules taken from pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fix_final_bias</strong> (<em>Tensor/None</em>) – If given, the final bias is fixed to a specific output Tensor given by <em>fix_final_bias</em>. If None, standard initialization applies.</p></li>
<li><p><strong>prev_damping_factor</strong> (<em>float</em>) – If <em>fix_final_bias</em> is set, determines a damping factor that applies to all weights/biases before final bias, in order to reduce dependency on them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tensor</dt><dd><p>The final initialization tensor that is desired for the AmortizableMLP.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.bisection_n_newton">
<span id="numerical-inversion"></span><h3>Numerical inversion<a class="headerlink" href="#module-jammy_flows.layers.bisection_n_newton" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">grad_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">min_boundary=-100000.0</em>, <em class="sig-param">max_boundary=100000.0</em>, <em class="sig-param">num_bisection_iter=25</em>, <em class="sig-param">num_newton_iter=30</em>, <em class="sig-param">newton_tolerance=1e-14</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bisection and Newton iterations simulataneously in each 1-d subdimension in a given batch.
Due to Newton iterations the returned inverse is differentiable and can be used in automatic differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – The function to find the inverse of.</p></li>
<li><p><strong>grad_func</strong> (<em>function</em>) – The gradient function of the function.</p></li>
<li><p><strong>target_arg</strong> (<em>float Tensor</em>) – The argument at which the inverse functon should be evaluated. Tensor of size BXD where B is the batchsize, and D the dimension.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any extra arguments passed to <em>func</em>.</p></li>
<li><p><strong>min_boundary</strong> (<em>float</em>) – Minimum boundary for Bisection.</p></li>
<li><p><strong>max_boundary</strong> (<em>float</em>) – Maximum boundary for bisection.</p></li>
<li><p><strong>num_bisection_iter</strong> (<em>int</em>) – Number of bisection iterations.</p></li>
<li><p><strong>num_newton_iter</strong> (<em>int</em>) – Number of Newton iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (differentiable) inverse of the function <em>func</em> in each sub-dimension in each batch item.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_joint_func_and_grad">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton_joint_func_and_grad</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">joint_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">min_boundary=-100000.0</em>, <em class="sig-param">max_boundary=100000.0</em>, <em class="sig-param">num_bisection_iter=25</em>, <em class="sig-param">num_newton_iter=30</em>, <em class="sig-param">newton_tolerance=1e-14</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_joint_func_and_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bisection and Newton iterations simulataneously in each 1-d subdimension in a given batch.
Due to Newton iterations the returned inverse is differentiable and can be used in automatic differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – The function to find the inverse of.</p></li>
<li><p><strong>grad_func</strong> (<em>function</em>) – The gradient function of the function.</p></li>
<li><p><strong>target_arg</strong> (<em>float Tensor</em>) – The argument at which the inverse functon should be evaluated. Tensor of size BXD where B is the batchsize, and D the dimension.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any extra arguments passed to <em>func</em>.</p></li>
<li><p><strong>min_boundary</strong> (<em>float</em>) – Minimum boundary for Bisection.</p></li>
<li><p><strong>max_boundary</strong> (<em>float</em>) – Maximum boundary for bisection.</p></li>
<li><p><strong>num_bisection_iter</strong> (<em>int</em>) – Number of bisection iterations.</p></li>
<li><p><strong>num_newton_iter</strong> (<em>int</em>) – Number of Newton iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (differentiable) inverse of the function <em>func</em> in each sub-dimension in each batch item.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_slow">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton_slow</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">grad_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">min_boundary=-100000.0</em>, <em class="sig-param">max_boundary=100000.0</em>, <em class="sig-param">num_bisection_iter=25</em>, <em class="sig-param">num_newton_iter=30</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bisection and Newton iterations simulataneously in each 1-d subdimension in a given batch.
Due to Newton iterations the returned inverse is differentiable and can be used in automatic differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – The function to find the inverse of.</p></li>
<li><p><strong>grad_func</strong> (<em>function</em>) – The gradient function of the function.</p></li>
<li><p><strong>target_arg</strong> (<em>float Tensor</em>) – The argument at which the inverse functon should be evaluated. Tensor of size BXD where B is the batchsize, and D the dimension.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any extra arguments passed to <em>func</em>.</p></li>
<li><p><strong>min_boundary</strong> (<em>float</em>) – Minimum boundary for Bisection.</p></li>
<li><p><strong>max_boundary</strong> (<em>float</em>) – Maximum boundary for bisection.</p></li>
<li><p><strong>num_bisection_iter</strong> (<em>int</em>) – Number of bisection iterations.</p></li>
<li><p><strong>num_newton_iter</strong> (<em>int</em>) – Number of Newton iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (differentiable) inverse of the function <em>func</em> in each sub-dimension in each batch item.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_sphere">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton_sphere</code><span class="sig-paren">(</span><em class="sig-param">combined_func</em>, <em class="sig-param">find_tangent_func</em>, <em class="sig-param">basic_exponential_map_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">num_newton_iter=25</em>, <em class="sig-param">visualize=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs Newton iterations on the sphere over 1-dimensional potential functions via Exponential maps to find the inverse of a given exponential map on the sphere.
In initial tests it was found that a very precise application requires at least 40-50 ierations, even though one is already pretty close after 10 iterations.
Distributing the points randomly on the sphere dosnt really help, so every point is initialized just at (0,0,1).
In order for this to work properly, the function has to be globally dipheomorphic.
We follow <a class="reference external" href="https://arxiv.org/abs/0906.0874">https://arxiv.org/abs/0906.0874</a> (“A Jacobian inequality for gradient maps on the sphere and its application to directional statistics”),
in particular the implementation suggested in <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a> (“Normalizing Flows on Tori and Spheres”) to get this requirement satisfied for “exponential_map_flows”.</p>
</dd></dl>

</div>
<div class="section" id="helper-functions">
<h3>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="module-jammy_flows.layers.layer_base">
<span id="layers"></span><h2>Layers<a class="headerlink" href="#module-jammy_flows.layers.layer_base" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="jammy_flows.layers.layer_base.layer_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.layer_base.</code><code class="sig-name descname">layer_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all flow layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimension</strong> (<em>int</em>) – The intrinsic dimension of the flow.</p></li>
<li><p><strong>always_parametrize_in_embedding_space</strong> (<em>int</em>) – Required for subclasses to make decisions for embedding transformations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base._embedding_conditional_return">
<code class="sig-name descname">_embedding_conditional_return</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base._embedding_conditional_return" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a vector into embedded space. Is flow specific and must be implemented by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base._embedding_conditional_return_num">
<code class="sig-name descname">_embedding_conditional_return_num</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base._embedding_conditional_return_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of embedding space dimensions for this flow. Must be implemented by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.flow_mapping">
<code class="sig-name descname">flow_mapping</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">extra_inputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.flow_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the flow forward mapping, which is required for sampling.
Must be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.get_desired_init_parameters">
<code class="sig-name descname">get_desired_init_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.get_desired_init_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns desired init parameters for given flow.
Should be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.init_params">
<code class="sig-name descname">init_params</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.init_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes permanent params. Can only be invoked when PDF is non-conditional.
Must be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.inv_flow_mapping">
<code class="sig-name descname">inv_flow_mapping</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">extra_inputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.inv_flow_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the flow inverse mapping, which is required for evaluation.
Must be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.obtain_layer_param_structure">
<code class="sig-name descname">obtain_layer_param_structure</code><span class="sig-paren">(</span><em class="sig-param">param_dict</em>, <em class="sig-param">extra_inputs=None</em>, <em class="sig-param">previous_x=None</em>, <em class="sig-param">extra_prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.obtain_layer_param_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful for debugging purposes. Must be overwritten by subclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param_dict</strong> (<em>dict</em>) – Is handed over from <em>jammy_flows.pdf</em> class and filled in this function with current values via param_dict[<em>par_name</em>]=*par_value*.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.transform_target_space">
<code class="sig-name descname">transform_target_space</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">log_det=0.0</em>, <em class="sig-param">trafo_from='default'</em>, <em class="sig-param">trafo_to='embedding'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.transform_target_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the target vector from a given parametrization to another parametrization.
Must be implemented by subclass.</p>
</dd></dl>

</dd></dl>

<div class="section" id="euclidean-flow-layers">
<h3>Euclidean flow layers<a class="headerlink" href="#euclidean-flow-layers" title="Permalink to this headline">¶</a></h3>
<div class="section" id="module-jammy_flows.layers.euclidean.euclidean_base">
<span id="euclidean-base"></span><h4>Euclidean Base<a class="headerlink" href="#module-jammy_flows.layers.euclidean.euclidean_base" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.euclidean_base.euclidean_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.euclidean_base.</code><code class="sig-name descname">euclidean_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_base.euclidean_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.euclidean_base.euclidean_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_base.euclidean_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all Euclidean flow layers. Inherits from layer_base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_offset</strong> (<em>int</em>) – If set, models an extra offset for the Euclidean flow. Will be done automatically by <em>jammy_flows</em> pdf class. Only makes sense for the last flow layer in a sequence of Euclidean flows.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.euclidean.euclidean_do_nothing">
<span id="identity-layer-x"></span><h4>Identity layer (“x”)<a class="headerlink" href="#module-jammy_flows.layers.euclidean.euclidean_do_nothing" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.euclidean_do_nothing.</code><code class="sig-name descname">euclidean_do_nothing</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Identitiy transformation. Symbol “x”</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.euclidean.multivariate_normal">
<span id="multivariate-normal-t"></span><h4>Multivariate Normal (“t”)<a class="headerlink" href="#module-jammy_flows.layers.euclidean.multivariate_normal" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.multivariate_normal.mvn_block">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.multivariate_normal.</code><code class="sig-name descname">mvn_block</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">cov_type='full'</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">width_smooth_saturation=1</em>, <em class="sig-param">lower_bound_for_widths=0.01</em>, <em class="sig-param">upper_bound_for_widths=100</em>, <em class="sig-param">softplus_for_width=0</em>, <em class="sig-param">clamp_widths=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.multivariate_normal.mvn_block" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.multivariate_normal.mvn_block.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">cov_type='full'</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">width_smooth_saturation=1</em>, <em class="sig-param">lower_bound_for_widths=0.01</em>, <em class="sig-param">upper_bound_for_widths=100</em>, <em class="sig-param">softplus_for_width=0</em>, <em class="sig-param">clamp_widths=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.multivariate_normal.mvn_block.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Affine flow (Multivariate Normal Distribution) - Symbol “t”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov_type</strong> (<em>str</em>) – One of [“full”, “diagonal”, “diagonal_symmetric”, “identity”]. “diagonal_symmetric” means one shared covariance parameter for all dimensions.</p></li>
<li><p><strong>width_smooth_saturation</strong> (<em>int</em>) – If set, uses smooth function also for lower end to describe log-width of variance-like parameters.</p></li>
<li><p><strong>lower_bound_for_widths</strong> (<em>float</em>) – Lower bound for the variance-like parameters.</p></li>
<li><p><strong>upper_bound_for_widths</strong> (<em>float</em>) – Upper bound for the variance-like parameters.</p></li>
<li><p><strong>softplus_for_width</strong> (<em>int</em>) – If set, uses softplus instead of exponential to enforce positivity on variance-like parameters.</p></li>
<li><p><strong>clamp_widths</strong> (<em>int</em>) – If set, clamps widths.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.euclidean.gaussianization_flow">
<span id="gaussianization-flow-g"></span><h4>Gaussianization flow (“g”)<a class="headerlink" href="#module-jammy_flows.layers.euclidean.gaussianization_flow" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.gaussianization_flow.gf_block">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.gaussianization_flow.</code><code class="sig-name descname">gf_block</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">nonlinear_stretch_type='classic'</em>, <em class="sig-param">num_kde=5</em>, <em class="sig-param">num_householder_iter=-1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">fit_normalization=0</em>, <em class="sig-param">inverse_function_type='inormal_partly_precise'</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">softplus_for_width=0</em>, <em class="sig-param">width_smooth_saturation=1</em>, <em class="sig-param">lower_bound_for_widths=0.01</em>, <em class="sig-param">upper_bound_for_widths=100</em>, <em class="sig-param">clamp_widths=0</em>, <em class="sig-param">regulate_normalization=0</em>, <em class="sig-param">add_skewness=0</em>, <em class="sig-param">rotation_mode='householder'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.gaussianization_flow.gf_block" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.gaussianization_flow.gf_block.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">nonlinear_stretch_type='classic'</em>, <em class="sig-param">num_kde=5</em>, <em class="sig-param">num_householder_iter=-1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">fit_normalization=0</em>, <em class="sig-param">inverse_function_type='inormal_partly_precise'</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">softplus_for_width=0</em>, <em class="sig-param">width_smooth_saturation=1</em>, <em class="sig-param">lower_bound_for_widths=0.01</em>, <em class="sig-param">upper_bound_for_widths=100</em>, <em class="sig-param">clamp_widths=0</em>, <em class="sig-param">regulate_normalization=0</em>, <em class="sig-param">add_skewness=0</em>, <em class="sig-param">rotation_mode='householder'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.gaussianization_flow.gf_block.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussianization flow: Symbol “g”</p>
<p>Implements <a class="reference external" href="https://arxiv.org/abs/2003.01941">https://arxiv.org/abs/2003.01941</a> as a modified version of the official implementation in <a class="reference external" href="https://github.com/chenlin9/Gaussianization_Flows">https://github.com/chenlin9/Gaussianization_Flows</a>. Fixes numerical issues with bisection inversion due to more efficient newton iterations, which also makes samples differentiable + fixes numerical issues with inverse CDF parametrization. Also allows
for amortization (the original implementation is meant only for non-conditional PDFs). Further adds multiple rotation parametrizations, logistic skewness option, and an rq-spline option for the non-linear mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimension</strong> (<em>int</em>) – Dimension of the PDF. Set by <em>jammy_flows.pdf</em>.</p></li>
<li><p><strong>nonlinear_stretch_type</strong> (<em>str</em>) – One of [“classic”, “rq_splines”]. Default is classic, but also allows to replace non-linear mapping with rational quadratic splines.</p></li>
<li><p><strong>num_kde</strong> (<em>int</em>) – Number of KDE Kernels in each one-dimensional transformation.</p></li>
<li><p><strong>num_householder_iter</strong> (<em>int</em>) – if &lt;=0, no householder transformation is performed. If positive, it defines the number of parameters in householder transformations.</p></li>
<li><p><strong>fit_normalization</strong> (<em>int</em>) – If set, also fits the normalization.</p></li>
<li><p><strong>inverse_function_type</strong> (<em>str</em>) – One of [“partly_crude”, “partly_precise”, “full_pade”, “isgimoid”]. “Partly_crude” is implemented in the original repository (<a class="reference external" href="https://github.com/chenlin9/Gaussianization_Flows">https://github.com/chenlin9/Gaussianization_Flows</a>), but has numerical issues. The option “isigmoid” “is an easier inverse CDF that looses exact CDF identification but gains some speed and is numerically stable. It is recommended to use “isigmoid” or “partly_precise”.</p></li>
<li><p><strong>model_offset</strong> (<em>int</em>) – Set by <em>jammy_flows.pdf</em>.</p></li>
<li><p><strong>softplus_for_width</strong> (<em>int</em>) – If set, uses <em>soft_plus</em> to predict width. Otherwhise exponential function.</p></li>
<li><p><strong>width_smooth_saturaiton</strong> (<em>int</em>) – If set, saturates the width symmetrically at the lower and upper end.</p></li>
<li><p><strong>lower_bound_for_widths</strong> (<em>float</em>) – Determines the lower width bound.</p></li>
<li><p><strong>upper_bound_for_widths</strong> (<em>float</em>) – Determines the upper width bound.</p></li>
<li><p><strong>clamp_widths</strong> (<em>int</em>) – If set, clamps widths above threshold.</p></li>
<li><p><strong>regulate_normalization</strong> (<em>int</em>) – If set, regulates with a lower bound of 1 and upper bound of 100 (fixed) similar to width regulation.</p></li>
<li><p><strong>add_skewness</strong> (<em>int</em>) – If set, adds skewness to the basis functions in order to make flow more flexible.</p></li>
<li><p><strong>rotation_mode</strong> (<em>str</em>) – <p>One of different rotation parametrizations:</p>
<div class="line-block">
<div class="line">- <strong>householder</strong>: Default implementation from the original paper.</div>
<div class="line">- <strong>angles</strong>: Parametrized via “Givens rotation”</div>
<div class="line">- <strong>triangular_combination</strong>: Parametrization of an upper and lower triangular matrix.</div>
<div class="line">- <strong>cayley</strong>: “Cayley representation” of rotations.</div>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.euclidean.polynomial_stretch_flow">
<span id="polynomial-stretch-flow-p"></span><h4>Polynomial stretch flow (“p”)<a class="headerlink" href="#module-jammy_flows.layers.euclidean.polynomial_stretch_flow" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.polynomial_stretch_flow.</code><code class="sig-name descname">psf_block</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">num_transforms=3</em>, <em class="sig-param">num_householder_iter=-1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">exact_mode=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">num_transforms=3</em>, <em class="sig-param">num_householder_iter=-1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">exact_mode=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Polynomial stretch flow - Symbol: “p”</p>
<p>A polynomial flow that uses <em>abs(x)</em> to make arbitrary polynomials work as flow-mappings. Has interesting structure but does not seem to work very well in practice.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-jammy_flows.layers.spheres.sphere_base">
<span id="spherical-flow-layers"></span><h3>Spherical flow layers<a class="headerlink" href="#module-jammy_flows.layers.spheres.sphere_base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.layers.spheres.sphere_base.sphere_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.sphere_base.</code><code class="sig-name descname">sphere_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">rotation_mode='householder'</em>, <em class="sig-param">add_rotation=False</em>, <em class="sig-param">higher_order_cylinder_parametrization=False</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.sphere_base.sphere_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.sphere_base.sphere_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">rotation_mode='householder'</em>, <em class="sig-param">add_rotation=False</em>, <em class="sig-param">higher_order_cylinder_parametrization=False</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.sphere_base.sphere_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all spherical flow layers. Inherits from layer_base.</p>
<p>add_rotation (int): If set, adds an additional rotation as an additional “flow”.
rotation_mode (str): One of [“angles”, “householder”]. <em>Angles</em> involves Givens Rotations, and <em>householder</em> householder rotations.</p>
</dd></dl>

</dd></dl>

<div class="section" id="module-jammy_flows.layers.spheres.spherical_do_nothing">
<span id="identity-layer-y"></span><h4>Identity layer (“y”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.spherical_do_nothing" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.spherical_do_nothing.</code><code class="sig-name descname">spherical_do_nothing</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Spherical identity mapping: Symbol “y”</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.moebius_1d">
<span id="moebius-1-d-circle-flow-m"></span><h4>Moebius 1-d circle flow (“m”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.moebius_1d" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.moebius_1d.moebius">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.moebius_1d.</code><code class="sig-name descname">moebius</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">use_moebius_xyz_parametrization=True</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.moebius_1d.moebius" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.moebius_1d.moebius.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">use_moebius_xyz_parametrization=True</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.moebius_1d.moebius.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Moebius transformations on the circle. Symbol “m”</p>
<p>Follows <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a>. Parametrization seems to be slightly unstable sometimes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>natural_direction</strong> (<em>int</em>) – If set to 0, log-probability is faster than sampling. Otherwise reversed.</p></li>
<li><p><strong>use_moebius_xyz_parametreization</strong> (<em>bool</em>) – Two different paramerizations.</p></li>
<li><p><strong>num_basis_functions</strong> (<em>int</em>) – Number of moebius basis functions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.splines_1d">
<span id="circular-1-d-spline-flow-o"></span><h4>Circular 1-d spline flow (“o”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.splines_1d" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.splines_1d.spline_1d">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.splines_1d.</code><code class="sig-name descname">spline_1d</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.splines_1d.spline_1d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.splines_1d.spline_1d.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.splines_1d.spline_1d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>A circular spline variant. Symbol: “o”</p>
<p>Follows <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a>. Still experimental and has not really been tested.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.segmented_sphere_nd">
<span id="segmented-2-d-sphere-flow-n"></span><h4>Segmented 2-d sphere flow (“n”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.segmented_sphere_nd" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.segmented_sphere_nd.segmented_sphere_nd">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.segmented_sphere_nd.</code><code class="sig-name descname">segmented_sphere_nd</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=1</em>, <em class="sig-param">rotation_mode='householder'</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">use_moebius_xyz_parametrization=True</em>, <em class="sig-param">num_basis_functions=5</em>, <em class="sig-param">zenith_type_layers='g'</em>, <em class="sig-param">max_rank=20</em>, <em class="sig-param">hidden_dims='64'</em>, <em class="sig-param">subspace_mapping='logistic'</em>, <em class="sig-param">higher_order_cylinder_parametrization=False</em>, <em class="sig-param">highway_mode=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.segmented_sphere_nd.segmented_sphere_nd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.segmented_sphere_nd.segmented_sphere_nd.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=1</em>, <em class="sig-param">rotation_mode='householder'</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">use_moebius_xyz_parametrization=True</em>, <em class="sig-param">num_basis_functions=5</em>, <em class="sig-param">zenith_type_layers='g'</em>, <em class="sig-param">max_rank=20</em>, <em class="sig-param">hidden_dims='64'</em>, <em class="sig-param">subspace_mapping='logistic'</em>, <em class="sig-param">higher_order_cylinder_parametrization=False</em>, <em class="sig-param">highway_mode=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.segmented_sphere_nd.segmented_sphere_nd.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>A segmented conditional flow that models a flow on the torus and then maps to the sphere. Symbol “n”</p>
<p>Follows <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a>. Seems to be stable when non-conditional, but can be unstable in certain configurations in conditional mode.
Slight modification, in that instead of the torus one can also choose an infinite torus, whose z-axis is modeled via a Euclidean flow instead of an interval flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rotation_mode</strong> (<em>str</em>) – One of [“angles, “householder”]</p></li>
<li><p><strong>use_moebius_xyz_parametreization</strong> (<em>bool</em>) – Two different parametrizations for the Moebius part.</p></li>
<li><p><strong>num_basis_functions</strong> (<em>int</em>) – Number of Moebius basis functions.</p></li>
<li><p><strong>zenith_type_layers</strong> (<em>str</em>) – Either “g” or multiple “gg” (Gaussianization flows) for infinite torus parametrization, or “r” or multiple “rr” (Rational-Quadratic Spline) for torus parametrization.</p></li>
<li><p><strong>max_rank</strong> (<em>int</em>) – Max rank of the MLP that maps from azimuth to zenith dimension.</p></li>
<li><p><strong>hidden_dims</strong> (<em>str/int/list</em><em>(</em><em>int</em><em>)</em>) – Hidden dims of MLP that maps from azimuth to zenith dimension.</p></li>
<li><p><strong>higher_order_cylinder_parametrization</strong> (<em>bool</em>) – Slightly different parametrization which allows some simplifications in intermedate steps. Default False (makes it hard to combine spherical flows).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.exponential_map_s2">
<span id="exponential-map-2-d-sphere-flow-v"></span><h4>Exponential map 2-d sphere flow (“v”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.exponential_map_s2" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.exponential_map_s2.exponential_map_s2">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.exponential_map_s2.</code><code class="sig-name descname">exponential_map_s2</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">exp_map_type='linear'</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">num_components=10</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.exponential_map_s2.exponential_map_s2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.exponential_map_s2.exponential_map_s2.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">exp_map_type='linear'</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">num_components=10</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.exponential_map_s2.exponential_map_s2.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the spherical exponential map. Symbol: “v”</p>
<p>Uses linear and quadratic potential as described in <a class="reference external" href="https://arxiv.org/abs/0906.0874">https://arxiv.org/abs/0906.0874</a>, and exponential potential as described in <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a>.
Additionally added a spline-based potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_map_type</strong> (<em>str</em>) – Defines the potential of the exponential map. One of [“linear”, “quadratic”, “exponential”, “splines”].</p></li>
<li><p><strong>natural_direction</strong> (<em>int</em>) – </p></li>
<li><p><strong>num_components</strong> (<em>int</em>) – How many components to sum over in the exponential map.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.cnf_sphere_charts">
<span id="chart-based-continuous-2-d-sphere-flow-c"></span><h4>Chart-based continuous 2-d sphere flow (“c”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.cnf_sphere_charts" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.cnf_sphere_charts.cnf_sphere_charts">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.cnf_sphere_charts.</code><code class="sig-name descname">cnf_sphere_charts</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">cnf_network_hidden_dims='64-64'</em>, <em class="sig-param">cnf_network_rank=0</em>, <em class="sig-param">cnf_network_highway_mode=1</em>, <em class="sig-param">num_charts=6</em>, <em class="sig-param">solver='rk4'</em>, <em class="sig-param">atol=1e-07</em>, <em class="sig-param">rtol=1e-07</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.cnf_sphere_charts.cnf_sphere_charts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.cnf_sphere_charts.cnf_sphere_charts.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">cnf_network_hidden_dims='64-64'</em>, <em class="sig-param">cnf_network_rank=0</em>, <em class="sig-param">cnf_network_highway_mode=1</em>, <em class="sig-param">num_charts=6</em>, <em class="sig-param">solver='rk4'</em>, <em class="sig-param">atol=1e-07</em>, <em class="sig-param">rtol=1e-07</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.cnf_sphere_charts.cnf_sphere_charts.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Continuous manifold normalizing flow - Symbol: “c”</p>
<p>Code implementation of “Neural manifold ordinary differential equations” (<a class="reference external" href="https://arxiv.org/abs/2006.10254">https://arxiv.org/abs/2006.10254</a>).
Mostly adapted from <a class="reference external" href="https://github.com/CUAI/Neural-Manifold-Ordinary-Differential-Equations">https://github.com/CUAI/Neural-Manifold-Ordinary-Differential-Equations</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cnf_network_hidden_dims</strong> (<em>str/int/list</em><em>(</em><em>int</em><em>)</em>) – Hidden dim structure of MLP.</p></li>
<li><p><strong>cnf_network_rank</strong> – (int, list(int)): Low rank structure of MLP.</p></li>
<li><p><strong>cnf_network_highway_mode</strong> (<em>int</em>) – Highway connectivity mode of MLP.</p></li>
<li><p><strong>num_charts</strong> (<em>int</em>) – How many charts to use.</p></li>
<li><p><strong>solver</strong> (<em>str</em>) – One of [“rk4”, “dopri5”, “dopri8”, “bosh3”, “fehlberg2”, “adaptive_heun”, “euler”, “midpoint”].</p></li>
<li><p><strong>atol</strong> (<em>float</em>) – Absolute tolerance.</p></li>
<li><p><strong>rtol</strong> (<em>float</em>) – Relative tolerance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-jammy_flows.layers.intervals.interval_base">
<span id="interval-flow-layers"></span><h3>Interval flow layers<a class="headerlink" href="#module-jammy_flows.layers.intervals.interval_base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.layers.intervals.interval_base.interval_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.intervals.interval_base.</code><code class="sig-name descname">interval_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_interval_as_first=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">low_boundary=0.0</em>, <em class="sig-param">high_boundary=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.interval_base.interval_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.intervals.interval_base.interval_base.transform_target_space">
<code class="sig-name descname">transform_target_space</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">log_det=0.0</em>, <em class="sig-param">transform_from='default'</em>, <em class="sig-param">transform_to='embedding'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.interval_base.interval_base.transform_target_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the target vector from a given parametrization to another parametrization.
Must be implemented by subclass.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-jammy_flows.layers.intervals.interval_do_nothing"></span><dl class="class">
<dt id="jammy_flows.layers.intervals.interval_do_nothing.interval_do_nothing">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.intervals.interval_do_nothing.</code><code class="sig-name descname">interval_do_nothing</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_interval_as_first=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">low_boundary=0.0</em>, <em class="sig-param">high_boundary=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.interval_do_nothing.interval_do_nothing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-jammy_flows.layers.intervals.rational_quadratic_spline"></span><dl class="class">
<dt id="jammy_flows.layers.intervals.rational_quadratic_spline.rational_quadratic_spline">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.intervals.rational_quadratic_spline.</code><code class="sig-name descname">rational_quadratic_spline</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">num_basis_elements=10</em>, <em class="sig-param">euclidean_to_interval_as_first=0</em>, <em class="sig-param">use_permanent_parameters=0</em>, <em class="sig-param">low_boundary=0</em>, <em class="sig-param">high_boundary=1.0</em>, <em class="sig-param">min_width=0.0001</em>, <em class="sig-param">min_height=0.0001</em>, <em class="sig-param">min_derivative=0.0001</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.rational_quadratic_spline.rational_quadratic_spline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.simplex.simplex_base">
<span id="simplex-flow-layers"></span><h3>Simplex flow layers<a class="headerlink" href="#module-jammy_flows.layers.simplex.simplex_base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.simplex.simplex_base.</code><code class="sig-name descname">simplex_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em>, <em class="sig-param">project_from_gauss_to_simplex=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em>, <em class="sig-param">project_from_gauss_to_simplex=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all simplex flow layers. Inherits from layer_base.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-jammy_flows.layers.simplex.inner_loop_simplex"></span><dl class="class">
<dt id="jammy_flows.layers.simplex.inner_loop_simplex.inner_loop_simplex">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.simplex.inner_loop_simplex.</code><code class="sig-name descname">inner_loop_simplex</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em>, <em class="sig-param">project_from_gauss_to_simplex=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.inner_loop_simplex.inner_loop_simplex" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.simplex.inner_loop_simplex.inner_loop_simplex.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em>, <em class="sig-param">project_from_gauss_to_simplex=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.inner_loop_simplex.inner_loop_simplex.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative simplex flow. Symbol: “w”</p>
<p>Construction suggested in <a class="reference external" href="https://arxiv.org/pdf/2008.05456.pdf">https://arxiv.org/pdf/2008.05456.pdf</a>.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>