<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Documentation &mdash; jammy_flows master documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> jammy_flows
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general">General</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.extra_functions">Main class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#amortizable-mlp">Amortizable MLP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.bisection_n_newton">Numerical inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#helper-functions">Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-jammy_flows.layers.layer_base">Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#euclidean-flow-layers">Euclidean flow layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.euclidean_base">Euclidean Base</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.euclidean_do_nothing">Identity layer (“x”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multivariate-normal-t">Multivariate Normal (“t”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gaussianization-flow-g">Gaussianization flow (“g”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.euclidean.polynomial_stretch_flow">Polynomial stretch flow (“p”)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.spheres.sphere_base">Spherical flow layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.spherical_do_nothing">Identity layer (“y”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.moebius_1d">Moebius 1-d circle flow (“m”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-jammy_flows.layers.spheres.splines_1d">Circular 1-d spline flow (“o”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#segmented-2-d-sphere-flow-n">Segmented 2-d sphere flow (“n”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exponential-map-2-d-sphere-flow-v">Exponential map 2-d sphere flow (“v”)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#chart-based-continuous-2-d-sphere-flow-c">Chart-based continuous 2-d sphere flow (“c”)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.intervals.interval_base">Interval flow layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-jammy_flows.layers.simplex.simplex_base">Simplex flow layers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">jammy_flows</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>API Documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/thoglu/jammy_flows/blob/main/docs/source/usage/api.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-jammy_flows.extra_functions">
<span id="main-class"></span><h3>Main class<a class="headerlink" href="#module-jammy_flows.extra_functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="jammy_flows.extra_functions.log_one_plus_exp_x_to_a_minus_1">
<code class="sig-prename descclassname">jammy_flows.extra_functions.</code><code class="sig-name descname">log_one_plus_exp_x_to_a_minus_1</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.extra_functions.log_one_plus_exp_x_to_a_minus_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the logarithm of ((1+exp(x))**a - 1) / ((1+exp(x))**a)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Size (B,D)</p></li>
<li><p><strong>a</strong> (<em>Tensor</em>) – Size (B,1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tensor</dt><dd><p>Result</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="amortizable-mlp">
<h3>Amortizable MLP<a class="headerlink" href="#amortizable-mlp" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="module-jammy_flows.layers.bisection_n_newton">
<span id="numerical-inversion"></span><h3>Numerical inversion<a class="headerlink" href="#module-jammy_flows.layers.bisection_n_newton" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">grad_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">min_boundary=-100000.0</em>, <em class="sig-param">max_boundary=100000.0</em>, <em class="sig-param">num_bisection_iter=25</em>, <em class="sig-param">num_newton_iter=30</em>, <em class="sig-param">newton_tolerance=1e-14</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bisection and Newton iterations simulataneously in each 1-d subdimension in a given batch.
Due to Newton iterations the returned inverse is differentiable and can be used in automatic differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – The function to find the inverse of.</p></li>
<li><p><strong>grad_func</strong> (<em>function</em>) – The gradient function of the function.</p></li>
<li><p><strong>target_arg</strong> (<em>float Tensor</em>) – The argument at which the inverse functon should be evaluated. Tensor of size BXD where B is the batchsize, and D the dimension.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any extra arguments passed to <em>func</em>.</p></li>
<li><p><strong>min_boundary</strong> (<em>float</em>) – Minimum boundary for Bisection.</p></li>
<li><p><strong>max_boundary</strong> (<em>float</em>) – Maximum boundary for bisection.</p></li>
<li><p><strong>num_bisection_iter</strong> (<em>int</em>) – Number of bisection iterations.</p></li>
<li><p><strong>num_newton_iter</strong> (<em>int</em>) – Number of Newton iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (differentiable) inverse of the function <em>func</em> in each sub-dimension in each batch item.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_joint_func_and_grad">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton_joint_func_and_grad</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">joint_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">min_boundary=-100000.0</em>, <em class="sig-param">max_boundary=100000.0</em>, <em class="sig-param">num_bisection_iter=25</em>, <em class="sig-param">num_newton_iter=30</em>, <em class="sig-param">newton_tolerance=1e-14</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_joint_func_and_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bisection and Newton iterations simulataneously in each 1-d subdimension in a given batch.
Due to Newton iterations the returned inverse is differentiable and can be used in automatic differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – The function to find the inverse of.</p></li>
<li><p><strong>grad_func</strong> (<em>function</em>) – The gradient function of the function.</p></li>
<li><p><strong>target_arg</strong> (<em>float Tensor</em>) – The argument at which the inverse functon should be evaluated. Tensor of size BXD where B is the batchsize, and D the dimension.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any extra arguments passed to <em>func</em>.</p></li>
<li><p><strong>min_boundary</strong> (<em>float</em>) – Minimum boundary for Bisection.</p></li>
<li><p><strong>max_boundary</strong> (<em>float</em>) – Maximum boundary for bisection.</p></li>
<li><p><strong>num_bisection_iter</strong> (<em>int</em>) – Number of bisection iterations.</p></li>
<li><p><strong>num_newton_iter</strong> (<em>int</em>) – Number of Newton iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (differentiable) inverse of the function <em>func</em> in each sub-dimension in each batch item.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_slow">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton_slow</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">grad_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">min_boundary=-100000.0</em>, <em class="sig-param">max_boundary=100000.0</em>, <em class="sig-param">num_bisection_iter=25</em>, <em class="sig-param">num_newton_iter=30</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_slow" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs bisection and Newton iterations simulataneously in each 1-d subdimension in a given batch.
Due to Newton iterations the returned inverse is differentiable and can be used in automatic differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – The function to find the inverse of.</p></li>
<li><p><strong>grad_func</strong> (<em>function</em>) – The gradient function of the function.</p></li>
<li><p><strong>target_arg</strong> (<em>float Tensor</em>) – The argument at which the inverse functon should be evaluated. Tensor of size BXD where B is the batchsize, and D the dimension.</p></li>
<li><p><strong>*args</strong> (<em>list</em>) – Any extra arguments passed to <em>func</em>.</p></li>
<li><p><strong>min_boundary</strong> (<em>float</em>) – Minimum boundary for Bisection.</p></li>
<li><p><strong>max_boundary</strong> (<em>float</em>) – Maximum boundary for bisection.</p></li>
<li><p><strong>num_bisection_iter</strong> (<em>int</em>) – Number of bisection iterations.</p></li>
<li><p><strong>num_newton_iter</strong> (<em>int</em>) – Number of Newton iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (differentiable) inverse of the function <em>func</em> in each sub-dimension in each batch item.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_sphere">
<code class="sig-prename descclassname">jammy_flows.layers.bisection_n_newton.</code><code class="sig-name descname">inverse_bisection_n_newton_sphere</code><span class="sig-paren">(</span><em class="sig-param">combined_func</em>, <em class="sig-param">find_tangent_func</em>, <em class="sig-param">basic_exponential_map_func</em>, <em class="sig-param">target_arg</em>, <em class="sig-param">*args</em>, <em class="sig-param">num_newton_iter=25</em>, <em class="sig-param">visualize=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.bisection_n_newton.inverse_bisection_n_newton_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs Newton iterations on the sphere over 1-dimensional potential functions via Exponential maps to find the inverse of a given exponential map on the sphere.
In initial tests it was found that a very precise application requires at least 40-50 ierations, even though one is already pretty close after 10 iterations.
Distributing the points randomly on the sphere dosnt really help, so every point is initialized just at (0,0,1).
In order for this to work properly, the function has to be globally dipheomorphic.
We follow <a class="reference external" href="https://arxiv.org/abs/0906.0874">https://arxiv.org/abs/0906.0874</a> (“A Jacobian inequality for gradient maps on the sphere and its application to directional statistics”),
in particular the implementation suggested in <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a> (“Normalizing Flows on Tori and Spheres”) to get this requirement satisfied for “exponential_map_flows”.</p>
</dd></dl>

</div>
<div class="section" id="helper-functions">
<h3>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="module-jammy_flows.layers.layer_base">
<span id="layers"></span><h2>Layers<a class="headerlink" href="#module-jammy_flows.layers.layer_base" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="jammy_flows.layers.layer_base.layer_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.layer_base.</code><code class="sig-name descname">layer_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all flow layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimension</strong> (<em>int</em>) – The intrinsic dimension of the flow.</p></li>
<li><p><strong>always_parametrize_in_embedding_space</strong> (<em>int</em>) – Required for subclasses to make decisions for embedding transformations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base._embedding_conditional_return">
<code class="sig-name descname">_embedding_conditional_return</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base._embedding_conditional_return" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a vector into embedded space. Is flow specific and must be implemented by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base._embedding_conditional_return_num">
<code class="sig-name descname">_embedding_conditional_return_num</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base._embedding_conditional_return_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of embedding space dimensions for this flow. Must be implemented by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.flow_mapping">
<code class="sig-name descname">flow_mapping</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">extra_inputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.flow_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the flow forward mapping, which is required for sampling.
Must be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.get_desired_init_parameters">
<code class="sig-name descname">get_desired_init_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.get_desired_init_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns desired init parameters for given flow.
Should be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.init_params">
<code class="sig-name descname">init_params</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.init_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes permanent params. Can only be invoked when PDF is non-conditional.
Must be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.inv_flow_mapping">
<code class="sig-name descname">inv_flow_mapping</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">extra_inputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.inv_flow_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the flow inverse mapping, which is required for evaluation.
Must be overwritten by subclass.</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.obtain_layer_param_structure">
<code class="sig-name descname">obtain_layer_param_structure</code><span class="sig-paren">(</span><em class="sig-param">param_dict</em>, <em class="sig-param">extra_inputs=None</em>, <em class="sig-param">previous_x=None</em>, <em class="sig-param">extra_prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.obtain_layer_param_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful for debugging purposes. Must be overwritten by subclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param_dict</strong> (<em>dict</em>) – Is handed over from <em>jammy_flows.pdf</em> class and filled in this function with current values via param_dict[<em>par_name</em>]=*par_value*.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.layer_base.layer_base.transform_target_space">
<code class="sig-name descname">transform_target_space</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">log_det=0.0</em>, <em class="sig-param">trafo_from='default'</em>, <em class="sig-param">trafo_to='embedding'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.layer_base.layer_base.transform_target_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the target vector from a given parametrization to another parametrization.
Must be implemented by subclass.</p>
</dd></dl>

</dd></dl>

<div class="section" id="euclidean-flow-layers">
<h3>Euclidean flow layers<a class="headerlink" href="#euclidean-flow-layers" title="Permalink to this headline">¶</a></h3>
<div class="section" id="module-jammy_flows.layers.euclidean.euclidean_base">
<span id="euclidean-base"></span><h4>Euclidean Base<a class="headerlink" href="#module-jammy_flows.layers.euclidean.euclidean_base" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.euclidean_base.euclidean_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.euclidean_base.</code><code class="sig-name descname">euclidean_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_base.euclidean_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.euclidean_base.euclidean_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_base.euclidean_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all Euclidean flow layers. Inherits from layer_base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_offset</strong> (<em>int</em>) – If set, models an extra offset for the Euclidean flow. Will be done automatically by <em>jammy_flows</em> pdf class. Only makes sense for the last flow layer in a sequence of Euclidean flows.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.euclidean.euclidean_do_nothing">
<span id="identity-layer-x"></span><h4>Identity layer (“x”)<a class="headerlink" href="#module-jammy_flows.layers.euclidean.euclidean_do_nothing" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.euclidean_do_nothing.</code><code class="sig-name descname">euclidean_do_nothing</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.euclidean_do_nothing.euclidean_do_nothing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Identitiy transformation. Symbol “x”</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="multivariate-normal-t">
<h4>Multivariate Normal (“t”)<a class="headerlink" href="#multivariate-normal-t" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="gaussianization-flow-g">
<h4>Gaussianization flow (“g”)<a class="headerlink" href="#gaussianization-flow-g" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="module-jammy_flows.layers.euclidean.polynomial_stretch_flow">
<span id="polynomial-stretch-flow-p"></span><h4>Polynomial stretch flow (“p”)<a class="headerlink" href="#module-jammy_flows.layers.euclidean.polynomial_stretch_flow" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.euclidean.polynomial_stretch_flow.</code><code class="sig-name descname">psf_block</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">num_transforms=3</em>, <em class="sig-param">num_householder_iter=-1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">exact_mode=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">num_transforms=3</em>, <em class="sig-param">num_householder_iter=-1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">model_offset=0</em>, <em class="sig-param">exact_mode=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.euclidean.polynomial_stretch_flow.psf_block.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Polynomial stretch flow - Symbol: “p”</p>
<p>A polynomial flow that uses <em>abs(x)</em> to make arbitrary polynomials work as flow-mappings. Has interesting structure but does not seem to work very well in practice.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-jammy_flows.layers.spheres.sphere_base">
<span id="spherical-flow-layers"></span><h3>Spherical flow layers<a class="headerlink" href="#module-jammy_flows.layers.spheres.sphere_base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.layers.spheres.sphere_base.sphere_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.sphere_base.</code><code class="sig-name descname">sphere_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">rotation_mode='householder'</em>, <em class="sig-param">add_rotation=False</em>, <em class="sig-param">higher_order_cylinder_parametrization=False</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.sphere_base.sphere_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.sphere_base.sphere_base.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">rotation_mode='householder'</em>, <em class="sig-param">add_rotation=False</em>, <em class="sig-param">higher_order_cylinder_parametrization=False</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.sphere_base.sphere_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all spherical flow layers. Inherits from layer_base.</p>
<p>dimension (int): Dimension of the flow. Set by parent.
add_rotation (int): If set, adds an additional rotation as an additional “flow”.
rotation_mode (str): One of [“angles”, “householder”]. <em>Angles</em> involves Givens Rotations, and <em>householder</em> householder rotations.</p>
</dd></dl>

</dd></dl>

<div class="section" id="module-jammy_flows.layers.spheres.spherical_do_nothing">
<span id="identity-layer-y"></span><h4>Identity layer (“y”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.spherical_do_nothing" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.spherical_do_nothing.</code><code class="sig-name descname">spherical_do_nothing</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_sphere_as_first=False</em>, <em class="sig-param">use_permanent_parameters=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.spherical_do_nothing.spherical_do_nothing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Spherical identity mapping: Symbol “y”</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.moebius_1d">
<span id="moebius-1-d-circle-flow-m"></span><h4>Moebius 1-d circle flow (“m”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.moebius_1d" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.moebius_1d.moebius">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.moebius_1d.</code><code class="sig-name descname">moebius</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">use_moebius_xyz_parametrization=True</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.moebius_1d.moebius" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.moebius_1d.moebius.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">use_moebius_xyz_parametrization=True</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.moebius_1d.moebius.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Moebius transformations on the circle. Symbol “m”</p>
<p>Follows <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a>. Parametrization seems to be slightly unstable sometimes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>natural_direction</strong> (<em>int</em>) – If set to 0, log-probability is faster than sampling. Otherwise reversed.</p></li>
<li><p><strong>use_moebius_xyz_parametreization</strong> (<em>bool</em>) – Two different paramerizations.</p></li>
<li><p><strong>num_basis_functions</strong> (<em>int</em>) – Number of moebius basis functions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.spheres.splines_1d">
<span id="circular-1-d-spline-flow-o"></span><h4>Circular 1-d spline flow (“o”)<a class="headerlink" href="#module-jammy_flows.layers.spheres.splines_1d" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="jammy_flows.layers.spheres.splines_1d.spline_1d">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.spheres.splines_1d.</code><code class="sig-name descname">spline_1d</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.splines_1d.spline_1d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.spheres.splines_1d.spline_1d.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_sphere_as_first=True</em>, <em class="sig-param">add_rotation=0</em>, <em class="sig-param">natural_direction=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">num_basis_functions=5</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.spheres.splines_1d.spline_1d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>A circular spline variant. Symbol: “o”</p>
<p>Follows <a class="reference external" href="https://arxiv.org/abs/2002.02428">https://arxiv.org/abs/2002.02428</a>. Still experimental and has not really been tested.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="segmented-2-d-sphere-flow-n">
<h4>Segmented 2-d sphere flow (“n”)<a class="headerlink" href="#segmented-2-d-sphere-flow-n" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="exponential-map-2-d-sphere-flow-v">
<h4>Exponential map 2-d sphere flow (“v”)<a class="headerlink" href="#exponential-map-2-d-sphere-flow-v" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="chart-based-continuous-2-d-sphere-flow-c">
<h4>Chart-based continuous 2-d sphere flow (“c”)<a class="headerlink" href="#chart-based-continuous-2-d-sphere-flow-c" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="module-jammy_flows.layers.intervals.interval_base">
<span id="interval-flow-layers"></span><h3>Interval flow layers<a class="headerlink" href="#module-jammy_flows.layers.intervals.interval_base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.layers.intervals.interval_base.interval_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.intervals.interval_base.</code><code class="sig-name descname">interval_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">euclidean_to_interval_as_first=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">low_boundary=0.0</em>, <em class="sig-param">high_boundary=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.interval_base.interval_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.intervals.interval_base.interval_base.transform_target_space">
<code class="sig-name descname">transform_target_space</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">log_det=0.0</em>, <em class="sig-param">transform_from='default'</em>, <em class="sig-param">transform_to='embedding'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.interval_base.interval_base.transform_target_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the target vector from a given parametrization to another parametrization.
Must be implemented by subclass.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-jammy_flows.layers.intervals.interval_do_nothing"></span><dl class="class">
<dt id="jammy_flows.layers.intervals.interval_do_nothing.interval_do_nothing">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.intervals.interval_do_nothing.</code><code class="sig-name descname">interval_do_nothing</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">euclidean_to_interval_as_first=0</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">low_boundary=0.0</em>, <em class="sig-param">high_boundary=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.interval_do_nothing.interval_do_nothing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-jammy_flows.layers.intervals.rational_quadratic_spline"></span><dl class="class">
<dt id="jammy_flows.layers.intervals.rational_quadratic_spline.rational_quadratic_spline">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.intervals.rational_quadratic_spline.</code><code class="sig-name descname">rational_quadratic_spline</code><span class="sig-paren">(</span><em class="sig-param">dimension</em>, <em class="sig-param">num_basis_elements=10</em>, <em class="sig-param">euclidean_to_interval_as_first=0</em>, <em class="sig-param">use_permanent_parameters=0</em>, <em class="sig-param">low_boundary=0</em>, <em class="sig-param">high_boundary=1.0</em>, <em class="sig-param">min_width=0.0001</em>, <em class="sig-param">min_height=0.0001</em>, <em class="sig-param">min_derivative=0.0001</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.intervals.rational_quadratic_spline.rational_quadratic_spline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-jammy_flows.layers.simplex.simplex_base">
<span id="simplex-flow-layers"></span><h3>Simplex flow layers<a class="headerlink" href="#module-jammy_flows.layers.simplex.simplex_base" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base">
<em class="property">class </em><code class="sig-prename descclassname">jammy_flows.layers.simplex.simplex_base.</code><code class="sig-name descname">simplex_base</code><span class="sig-paren">(</span><em class="sig-param">dimension=1</em>, <em class="sig-param">use_permanent_parameters=False</em>, <em class="sig-param">always_parametrize_in_embedding_space=0</em>, <em class="sig-param">project_from_gauss_to_simplex=0</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base.base_simplex_to_non_uniform_box">
<code class="sig-name descname">base_simplex_to_non_uniform_box</code><span class="sig-paren">(</span><em class="sig-param">inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base.base_simplex_to_non_uniform_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from the base simplex to box. This is not the canonical standard simplex. In 4-d, e.g. this base simplex is bounded by the vertices
(0,0,0,0), (1,0,0,0), (0,1,0,0), (0,0,1,0), (0,0,0,1),</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base.gauss_to_non_uniform_box">
<code class="sig-name descname">gauss_to_non_uniform_box</code><span class="sig-paren">(</span><em class="sig-param">inputs</em>, <em class="sig-param">use_gauss_projection=True</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base.gauss_to_non_uniform_box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base.non_uniform_box_to_base_simplex">
<code class="sig-name descname">non_uniform_box_to_base_simplex</code><span class="sig-paren">(</span><em class="sig-param">inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base.non_uniform_box_to_base_simplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from box to the (base) simplex aligned with the coordinate axes. This is not the canonical standard simplex. In 4-d, e.g. this base simplex is bounded by the vertices
(0,0,0,0), (1,0,0,0), (0,1,0,0), (0,0,1,0), (0,0,0,1),</p>
</dd></dl>

<dl class="method">
<dt id="jammy_flows.layers.simplex.simplex_base.simplex_base.transform_target_space">
<code class="sig-name descname">transform_target_space</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">log_det=0.0</em>, <em class="sig-param">transform_from='default'</em>, <em class="sig-param">transform_to='embedding'</em><span class="sig-paren">)</span><a class="headerlink" href="#jammy_flows.layers.simplex.simplex_base.simplex_base.transform_target_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the target vector from a given parametrization to another parametrization.
Must be implemented by subclass.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>